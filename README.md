# 将棋AI対局・解説アプリケーション

AI同士の将棋対局をリアルタイムで解説付きで観戦できるWebアプリケーションです。

## 機能

- **AI対局機能**: 藤井聡太AIと加藤一二三AIによる実際のAI対局生成
- **AI解説機能**: OpenAI GPT-3.5による一手一手の詳細解説
- **棋譜ビューア機能**: インタラクティブな棋譜閲覧
- **盤面表示**: リアルタイムな盤面と持ち駒の表示
- **自動フォールバック**: API制限時はサンプルデータで動作継続

## セットアップ

### 1. 必要なライブラリのインストール

```bash
pip install -r requirements.txt
```

### 2. 環境変数の設定

`.env.example`を`.env`にコピーして、OpenAI APIキーを設定してください：

```bash
cp .env.example .env
```

`.env`ファイルを編集：
```
OPENAI_API_KEY=sk-your_actual_openai_api_key_here
```

**重要**: OpenAI APIキーを設定しない場合、アプリケーションはサンプルデータモードで動作します。

### 3. アプリケーションの起動

```bash
python app.py
```

アプリケーションは `http://localhost:8080` で起動します。

## 使用方法

1. ブラウザで `http://localhost:8080` にアクセス
2. 「対局開始」ボタンをクリック
3. AI対局の生成を待つ（初回は30-60秒程度）
   - OpenAI APIキーが設定されている場合：リアルタイムAI対局
   - APIキーが未設定の場合：サンプルデータを表示
4. 棋譜ビューアで対局を閲覧
   - 棋譜リストをクリックして好きな手数に移動
   - 矢印キーでナビゲーション
   - AI解説を読みながら対局を学習

## AI機能の仕組み

### AI対局生成
1. **手生成**: OpenAI GPT-3.5が現在の局面から次の最適手を選択
2. **解説生成**: 各手について戦術的な解説をAIが自動生成
3. **対局進行**: 最大30手まで自動で対局を進行
4. **エラー処理**: API制限やエラー時は自動でサンプルデータに切り替え

### パフォーマンス
- 初回生成時間: 30-60秒程度（30手分の対局）
- API呼び出し: 1手あたり約1-2秒
- フォールバック: サンプルデータで即座に表示

### API使用量目安
- 1対局あたり: 約60トークン×30手 = 1,800トークン
- 月額費用: 約$0.002-0.005程度（GPT-3.5使用時）

## キーボードショートカット

- `←` / `→`: 前の手 / 次の手
- `Home`: 初期局面
- `End`: 最終局面

## プロジェクト構造

```
Shogi/
├── app.py                 # メインのFlaskアプリケーション
├── requirements.txt       # 必要なライブラリ
├── .env.example          # 環境変数のサンプル
├── templates/            # HTMLテンプレート
│   ├── index.html        # メインページ
│   └── viewer.html       # 棋譜ビューア
└── static/              # 静的ファイル
    ├── css/
    │   └── style.css     # スタイルシート
    └── js/
        ├── main.js       # メインページのJavaScript
        └── viewer.js     # ビューアのJavaScript
```

## 開発状況

### 完成済み
- ✅ 基本的なWebアプリケーション構造
- ✅ **実際のAI対局生成機能**（OpenAI GPT-3.5使用）
- ✅ **リアルタイムAI解説機能**
- ✅ インタラクティブな盤面表示
- ✅ 持ち駒表示
- ✅ 棋譜ダウンロード機能
- ✅ エラーハンドリングとフォールバック

### 今後の実装予定
- 🔄 より高度なAI思考アルゴリズム
- 🔄 対局結果の保存・管理
- 🔄 複数の対局履歴閲覧
- 🔄 ユーザー設定（AI強度調整など）

## 技術スタック

- **バックエンド**: Flask (Python)
- **将棋ロジック**: python-shogi
- **AI**: OpenAI API
- **フロントエンド**: HTML, CSS, JavaScript (素のJS)

## ライセンス

MIT License

## 貢献

プルリクエストやイシューの報告を歓迎します。
